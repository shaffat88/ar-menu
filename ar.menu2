<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AR Bites – Interactive AR Menu (Free)</title>
  <meta name="description" content="A free, single‑file AR restaurant menu. Tap any dish and hit the AR button to place it on your table." />
  
  <!-- Tailwind (via CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Google <model-viewer> for 3D + AR -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>

  <!-- QRCode generator -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <style>
    /* Star rating widget */
    .stars { display: inline-flex; gap: .25rem; cursor: pointer; }
    .star { font-size: 1.25rem; line-height: 1; }
    .star[data-active="true"] { filter: drop-shadow(0 0 0.5px rgba(0,0,0,.2)); }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header / Brand (Change the brand name below to yours) -->
  <header class="sticky top-0 z-10 bg-white/75 backdrop-blur shadow">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <span class="inline-block w-9 h-9 rounded-2xl bg-gradient-to-br from-amber-400 to-red-500"></span>
        <h1 class="text-xl sm:text-2xl font-extrabold tracking-tight">AR Bites — Interactive AR Menu</h1>
      </div>
      <button id="qrBtn" class="px-3 py-2 rounded-xl bg-gray-900 text-white text-sm shadow hover:bg-black">QR for this Page</button>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-8">
    <section class="mb-8">
      <p class="text-sm sm:text-base text-gray-700">Tap a dish to explore it in 3D, then press the <strong>AR</strong> button to place it on your table. Works on most Android phones (Scene Viewer) and iPhones (Quick Look). No app needed.</p>
      <p class="text-xs text-gray-500 mt-2">Tip: Replace the brand name above with your own. You can also duplicate a dish card and swap the model links to add more items.</p>
    </section>

    <!-- Menu Grid -->
    <section class="grid sm:grid-cols-2 gap-6">

      <!-- Dish 1: Avocado Salad -->
      <article class="bg-white rounded-2xl shadow p-4">
        <div class="flex items-start justify-between gap-3">
          <div>
            <h2 class="text-lg font-bold">Avocado Salad</h2>
            <p class="text-sm text-gray-500">Fresh avocado with herbs & olive oil</p>
          </div>
          <div class="text-right">
            <div class="text-lg font-semibold">$8.50</div>
            <div class="text-xs text-gray-500">~ 180g</div>
          </div>
        </div>

        <model-viewer
          src="https://github.com/KhronosGroup/glTF-Sample-Models/raw/refs/heads/main/2.0/Avocado/glTF-Binary/Avocado.glb"
          ios-src="https://asset-explorer.needle.tools/downloads/Avocado.glb.three.usdz"
          alt="3D model of an avocado"
          ar ar-modes="scene-viewer quick-look webxr" ar-scale="fixed" ar-placement="floor"
          camera-controls shadow-intensity="1" exposure="1" environment-image="neutral"
          poster="https://modelviewer.dev/assets/posters/green.jpg"
          style="width:100%; height: 300px; border-radius: 1rem; overflow:hidden; background:#f3f4f6; margin-top:.75rem">
          <div class="progress-bar hide" slot="progress-bar">
            <div class="update-bar"></div>
          </div>
        </model-viewer>

        <!-- Ratings + Actions -->
        <div class="mt-3 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <div class="stars" data-dish="avocado"></div>
            <span id="avg-avocado" class="text-sm text-gray-600">—</span>
          </div>
          <a class="text-sm underline text-gray-700" href="https://wa.me/?text=Review%20for%20Avocado%20Salad:%20⭐️⭐️⭐️⭐️⭐️%20(Your%20comment%20here)" target="_blank" rel="noopener">Share review</a>
        </div>
      </article>

      <!-- Dish 2: Grilled Barramundi -->
      <article class="bg-white rounded-2xl shadow p-4">
        <div class="flex items-start justify-between gap-3">
          <div>
            <h2 class="text-lg font-bold">Grilled Barramundi</h2>
            <p class="text-sm text-gray-500">Lightly seasoned, served with lemon</p>
          </div>
          <div class="text-right">
            <div class="text-lg font-semibold">$12.90</div>
            <div class="text-xs text-gray-500">~ 220g</div>
          </div>
        </div>

        <model-viewer
          src="https://github.com/KhronosGroup/glTF-Sample-Models/raw/refs/heads/main/2.0/BarramundiFish/glTF-Binary/BarramundiFish.glb"
          ios-src="https://asset-explorer.needle.tools/downloads/BarramundiFish.glb.three.usdz"
          alt="3D model of a barramundi fish"
          ar ar-modes="scene-viewer quick-look webxr" ar-scale="fixed" ar-placement="floor"
          camera-controls shadow-intensity="1" exposure="1" environment-image="neutral"
          poster="https://modelviewer.dev/assets/posters/blue.jpg"
          style="width:100%; height: 300px; border-radius: 1rem; overflow:hidden; background:#f3f4f6; margin-top:.75rem">
        </model-viewer>

        <!-- Ratings + Actions -->
        <div class="mt-3 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <div class="stars" data-dish="barramundi"></div>
            <span id="avg-barramundi" class="text-sm text-gray-600">—</span>
          </div>
          <a class="text-sm underline text-gray-700" href="https://wa.me/?text=Review%20for%20Grilled%20Barramundi:%20⭐️⭐️⭐️⭐️⭐️%20(Your%20comment%20here)" target="_blank" rel="noopener">Share review</a>
        </div>
      </article>

      <!-- HOW TO DUPLICATE: Copy any <article> block above, change the title/price and swap the src + ios-src links to your own model (GLB + USDZ). -->

    </section>

    <section class="mt-10 bg-white rounded-2xl p-5 shadow">
      <h3 class="text-base font-semibold mb-2">How to use this for your brand</h3>
      <ol class="text-sm text-gray-700 list-decimal pl-5 space-y-2">
        <li><strong>Change the brand name</strong> at the top ("AR Bites") to your restaurant name.</li>
        <li><strong>Add your dishes</strong>: duplicate a card and replace the <code>src</code> (GLB) and <code>ios-src</code> (USDZ) URLs.</li>
        <li><strong>Host it free</strong>: open <em>Netlify Drop</em> (drag‑and‑drop deploy) or GitHub Pages, upload this file, get a public HTTPS link.</li>
        <li><strong>Generate a QR</strong>: click the black “QR for this Page” button and print it for your tables.</li>
        <li><strong>Collect reviews</strong>: the stars save locally for each phone. For real reviews, replace the WhatsApp link with your <em>Google Form</em> or review system.</li>
      </ol>
      <p class="text-xs text-gray-500 mt-3">Models used here are public sample assets (CC0) from the Khronos glTF Sample Models. AR requires a modern smartphone; iOS Quick Look uses USDZ, Android Scene Viewer uses GLB.</p>
    </section>
  </main>

  <!-- QR Modal -->
  <div id="qrModal" class="fixed inset-0 bg-black/60 hidden items-center justify-center p-4">
    <div class="bg-white rounded-2xl max-w-sm w-full p-5">
      <div class="flex items-center justify-between mb-3">
        <h4 class="font-semibold">QR code for this page</h4>
        <button id="qrClose" class="text-sm px-2 py-1 bg-gray-100 rounded">Close</button>
      </div>
      <div id="qrcode" class="flex items-center justify-center p-4"></div>
      <p class="text-xs text-gray-500 text-center">Print this and put on your tables. When you re‑host at your own URL, regenerate the QR.</p>
    </div>
  </div>

  <script>
    // ---- Simple star rating stored in localStorage (per device) ----
    const dishes = [
      { key: 'avocado', avgEl: document.getElementById('avg-avocado') },
      { key: 'barramundi', avgEl: document.getElementById('avg-barramundi') }
    ];

    function getData(key){
      const raw = localStorage.getItem('rating_'+key);
      return raw ? JSON.parse(raw) : { sum: 0, count: 0 };
    }
    function setData(key, data){
      localStorage.setItem('rating_'+key, JSON.stringify(data));
    }
    function fmt(n){ return (Math.round(n*10)/10).toFixed(1); }

    function mountStars(container, key, avgEl){
      const data = getData(key);
      const avg = data.count? data.sum/data.count : 0;
      avgEl.textContent = data.count ? `${fmt(avg)} / 5 (${data.count})` : 'No ratings yet';

      // build stars 1..5
      for(let i=1;i<=5;i++){
        const s = document.createElement('button');
        s.className = 'star';
        s.setAttribute('aria-label', `${i} star`);
        s.innerHTML = i <= Math.round(avg) ? '⭐' : '☆';
        s.dataset.active = i <= Math.round(avg);
        s.addEventListener('click', () => {
          const d = getData(key);
          d.sum += i; d.count += 1; setData(key,d);
          // refresh
          [...container.children].forEach((c,idx)=> c.innerHTML = (idx+1) <= i ? '⭐' : '☆');
          avgEl.textContent = `${fmt(d.sum/d.count)} / 5 (${d.count})`;
        });
        container.appendChild(s);
      }
    }

    document.querySelectorAll('.stars').forEach(el => {
      const key = el.dataset.dish;
      const dish = dishes.find(d => d.key === key);
      if(dish) mountStars(el, key, dish.avgEl);
    });

    // ---- QR modal ----
    const qrBtn = document.getElementById('qrBtn');
    const qrModal = document.getElementById('qrModal');
    const qrClose = document.getElementById('qrClose');
    const qrcodeBox = document.getElementById('qrcode');

    qrBtn.addEventListener('click', () => {
      qrModal.classList.remove('hidden');
      qrcodeBox.innerHTML = '';
      new QRCode(qrcodeBox, { text: window.location.href, width: 220, height: 220 });
    });

    qrClose.addEventListener('click', () => qrModal.classList.add('hidden'));
    qrModal.addEventListener('click', (e) => { if(e.target === qrModal) qrModal.classList.add('hidden'); });
  </script>
</body>
</html>
